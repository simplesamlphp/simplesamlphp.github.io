<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SSPSA 201809-02: Dangerous use of file_get_contents - SimpleSAMLphp</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.org/security/201809-02.html">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.org/feed.xml">
</head>

  <body>
      <!-- Red logo header -->
  <header>
  <div id="header">
    <div class="right">
      <form style="margin-top: 2.5rem; margin-right: 2rem" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />
        <input type="search" name="q" placeholder="Search" value="" />
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <nav>
  <div id="headerbar" style="clear: both">
  <p id="breadcrumb"><a href="https://simplesamlphp.org">Home</a> Â» SSPSA 201809-02: Dangerous use of file_get_contents</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/contrib/">Contribute</a>
      </div>
      <div class="menuitem">
        <a href="https://github.com/simplesamlphp/simplesamlphp/projects?type=classic">Roadmap</a>
      </div>
      <div class="menuitem">
        <a href="/awards">Awards</a>
      </div>
      <div class="menuitem">
        <a href="/users/">Users</a>
      </div>
      <div class="menuitem">
        <a href="/lists/">Mailing lists</a>
      </div>
      <div class="menuitem last">
        <a href="/support/">Support</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px" />
  <br style="height: 0px; clear: both" />
  </div><!-- /#headerbar -->
  </nav>
  </header>

  <main>

    <aside><div class="sidebar-warning" style="float: right;">
<h2>Date</h2>
September 27, 2018
<h2>Affected versions</h2>
<code>robrichards/xmlseclibs &lt;= 3.0.1</code><br />
<code>robrichards/xmlseclibs &lt;= 2.0.1</code><br />
<code>robrichards/xmlseclibs &lt;= 1.4.2</code>
<h2>Severity</h2>
Info
</div></aside>

<h1 id="201809-02">201809-02</h1>

<p><strong>Dangerous use of file_get_contents</strong></p>

<h3 id="background">Background</h3>

<p>XMLSecLibs is a library written by Rob Richards that implements the
<a href="https://www.w3.org/TR/2002/REC-xmlenc-core-20021210/Overview.html">xml-enc</a> and
<a href="https://www.w3.org/TR/xmldsig-core1/">xml-dsig</a> W3C recommendations. It allows its users to handle encrypted and
digitally signed XML documents. SimpleSAMLphp delegates encryption and signature handling to this library.</p>

<h3 id="description">Description</h3>

<p>When processing node references in the <code class="language-plaintext highlighter-rouge">getRefNodeID()</code> function of the <code class="language-plaintext highlighter-rouge">XMLSecurityDSig</code> class, URIs are parsed by
means of the <code class="language-plaintext highlighter-rouge">parse_url()</code> function. When no fragment is parsed by the function, the URI is considered an external
reference that needs to be loaded, and the <code class="language-plaintext highlighter-rouge">file_get_contents()</code> function is used for that.</p>

<p>Unfortunately, <code class="language-plaintext highlighter-rouge">file_get_contents()</code> is a dangerous function when used with data obtained from user input, as it is the
case. Using it could allow diverse kinds of attacks, from Denial of Service to loading of remote malicious resources.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>All <strong>robrichards/xmlseclibs</strong> versions 1.x, 2.x and 3.x are affected, up to (including) <strong>1.4.2</strong>, <strong>2.0.1</strong> and
<strong>3.0.1</strong>, respectively.</p>

<h3 id="impact">Impact</h3>

<p>No way to take advantage of this issue has been identified, given that the argument passed to <code class="language-plaintext highlighter-rouge">file_get_contents()</code> is
the object result of parsing a URI, instead of the string containing the URI itself.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade to the latest versions of the library.</p>

<p>For SimpleSAMLphp users, run <code class="language-plaintext highlighter-rouge">composer update</code> or upgrade to SimpleSAMLphp 1.16. Refer to the documentation for
instructions on how to <a href="https://simplesamlphp.org/docs/stable/simplesamlphp-install-repo">run composer</a>.</p>

<h3 id="credit">Credit</h3>

<p>This security issue was discovered during a security audit performed by Cure53 and reported on December 18, 2017.</p>

    </main>


  </body>
</html>
