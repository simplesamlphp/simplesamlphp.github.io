<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; form-action 'self'; object-src 'none'; script-src 'self'; style-src 'self'; font-src 'self'; connect-src 'self'; img-src 'self' data:; base-uri 'none'">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8; X-Content-Type-Options=nosniff">
  <meta name="referrer" content="same-origin" />

  <title>SSPSA 201612-04: Session fixation attack against the OAuth Request Token approval flow - SimpleSAMLphp</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.org/security/2017XX-XX.html">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.org/feed.xml">
</head>

  <body>
      <!-- Red logo header -->
  <header>
  <div id="header">
    <div class="right">
      <form class="searchbox" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />
        <input type="search" name="q" placeholder="Search" value="" />
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.org">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <nav>
  <div id="headerbar">
  <p id="breadcrumb"><a href="https://simplesamlphp.org">Home</a> Â» SSPSA 201612-04: Session fixation attack against the OAuth Request Token approval flow</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/support/">Support</a>
      </div>
      <div class="menuitem last">
        <a href="/contrib/">Contribute</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px">
    <br style="height: 0px; clear: both">
  </div><!-- /#headerbar -->
  </nav>
  </header>

  <main>

    <aside><div class="sidebar-warning right">
<h2>Date</h2>
March 30, 2017
<h2>Affected versions</h2>
<code>SimpleSAMLphp &lt;= 1.14.11</code>
<h2>Severity</h2>
Medium
</div></aside>

<h1 id="201612-04">201612-04</h1>

<p><strong>Session fixation attack against the OAuth Request Token approval flow</strong></p>

<h3 id="background">Background</h3>

<p>A <a href="https://oauth.net/advisories/2009-1/">session fixation attack was discovered years ago</a> against the OAuth Request
Token approval flow in the OAuth 1.0 protocol. In order to fix this issue, the revision A of the protocol was
published.</p>

<h3 id="description">Description</h3>

<p>An attacker may craft a malicious link including a Request Token and send it to the victim, who may then approve the
use of that token without noticing there is an ongoing attack. The attacker is then able to complete the authorization
flow with such token, and access the protected resources that are exposed by the Consumer site as part of its service.
If the attacker has an account in the Consumer site, the access may then be persistent.</p>

<p>The <em>oauth</em> module in SimpleSAMLphp makes use of an external OAuth library which is included in the module itself. This
library was not compliant with Revision A of the OAuth 1.0 protocol, and therefore was vulnerable to the aforementioned
attack.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>All <strong>SimpleSAMLphp</strong> versions before and including <strong>1.14.11</strong>.</p>

<h3 id="impact">Impact</h3>

<p>Those using the <em>oauth</em> module may be affected by this issue, and therefore access to protected resources may be granted
to malicious third parties with the help of legitimate users clicking on a manually crafted URL and approving access
unsuspiciously.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade to the <a href="/download">latest version</a>.</p>

    </main>

<footer>
        <img class="logo" src="/res/ssplogo-fish-2.svg" alt="">
</footer>

  </body>
</html>
