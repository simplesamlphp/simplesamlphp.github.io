<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; form-action 'self'; frame-ancestors 'none'; object-src 'none'; script-src 'self'; style-src 'self'; font-src 'self'; connect-src 'self'; img-src 'self' data:; base-uri 'none'">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8; X-Content-Type-Options=nosniff">
  <meta http-equiv="X-Frame-Options" content="deny">
  <meta name="referrer" content="same-origin" />

  <title>SSPSA 201911-02: Information disclosure - SimpleSAMLphp</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.org/security/201911-02.html">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.org/feed.xml">
</head>

  <body>
      <!-- Red logo header -->
  <header>
  <div id="header">
    <div class="right">
      <form class="searchbox" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />
        <input type="search" name="q" placeholder="Search" value="" />
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.org">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <nav>
  <div id="headerbar">
  <p id="breadcrumb"><a href="https://simplesamlphp.org">Home</a> Â» SSPSA 201911-02: Information disclosure</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/support/">Support</a>
      </div>
      <div class="menuitem last">
        <a href="/contrib/">Contribute</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px">
    <br style="height: 0px; clear: both">
  </div><!-- /#headerbar -->
  </nav>
  </header>

  <main>

    <aside><div class="sidebar-warning right">
<h2>Date</h2>
November 19, 2019
<h2>Affected versions</h2>
<code>SimpleSAMLphp 1.17.0 - 1.17.7</code><br />
<h2>Severity</h2>
Low
</div></aside>

<h1 id="201911-02">201911-02</h1>

<p><strong>Information disclosure</strong></p>

<h3 id="background">Background</h3>

<p>SimpleSAMLphp 1.17 includes a preview of the new user interface to be included in the future version 2.0. This new user
interface can be enabled by setting the <code class="language-plaintext highlighter-rouge">usenewui</code> configuration option to <code class="language-plaintext highlighter-rouge">true</code>, and it includes a new admin interface
in a module called <em>admin</em>, which can be disabled.</p>

<h3 id="description">Description</h3>

<p>The new admin interface includes a way to view information about the host where SimpleSAMLphp is installed, by means of
the <code class="language-plaintext highlighter-rouge">phpinfo()</code> PHP function. An endpoint that exposes the output of that function is included in the admin module for
easier debugging.</p>

<p>The aforementioned endpoint had no checks for administrator privileges. This would allow any individual
to access the given endpoint without authenticating, gathering information about the affected system.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>All SimpleSAMLphp 1.17 versions up to 1.17.7 are affected, provided that the new, experimental use interface is enabled,
together with the new <em>admin</em> module.</p>

<h3 id="impact">Impact</h3>

<p>An attacker could leverage this issue by accessing the unprotected endpoint and gather intelligence about the host where
SimpleSAMLphp is deployed, using it later for their own advantage in case other issues arise.</p>

<p>However, the impact of this issue is deemed as low, given that the new user interface must be explicitly enabled by
means of the <code class="language-plaintext highlighter-rouge">usenewui</code> configuration option, and the new <em>admin</em> module must also be enabled.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade to SimpleSAMLphp 1.17.8 or 1.18. This can be done by downloading the package, or by running <code class="language-plaintext highlighter-rouge">composer update</code>.
Refer to the documentation for instructions on how to
<a href="https://simplesamlphp.org/docs/stable/simplesamlphp-install-repo">run composer</a>.</p>

<p>Alternatively, the issue can be mitigated by either disabling the new user interface by setting the <code class="language-plaintext highlighter-rouge">usenewui</code>
configuration option to <code class="language-plaintext highlighter-rouge">false</code>, or by disabling the <em>admin</em> module in the configuration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    'module.enable' =&gt; [
        ...
        'admin' =&gt; false,
        ...
    ],
</code></pre></div></div>

<h3 id="credit">Credit</h3>

<p>This security issue was reported  by Dirk-jan Mollema and reported on November 19, 2019.</p>

    </main>

<footer>
        <img class="logo" src="/res/ssplogo-fish-2.svg" alt="">
</footer>

  </body>
</html>
