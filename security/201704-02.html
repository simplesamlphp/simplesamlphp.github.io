<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Language" content="en" />
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SSPSA 201704-02: Authentication context bypass in the _multiauth_ module</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.github.io/security/201704-02.html">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.github.io/feed.xml" />
</head>

  <body>
      <!-- Red logo header -->
  <div id="header">
    <div class="right">
      <form style="margin-top: 2.5rem; margin-right: 2rem" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />
        <input type="search" name="q" placeholder="Search" value="" />
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.github.io" style="color: #fff; text-decoration: none">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <div id="headerbar" style="clear: both">
  <p id="breadcrumb"><a href="https://simplesamlphp.github.io">Home</a> » SSPSA 201704-02: Authentication context bypass in the _multiauth_ module</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/translation/">Translation</a>
      </div>
      <div class="menuitem">
        <a href="/developers/">Developers</a>
      </div>
      <div class="menuitem">
        <a href="https://github.com/simplesamlphp/simplesamlphp/projects">Roadmap</a>
      </div>
      <div class="menuitem">
        <a href="/awards">Awards</a>
      </div>
      <div class="menuitem">
        <a href="/users/">Users</a>
      </div>
      <div class="menuitem">
        <a href="/lists/">Mailing lists</a>
      </div>
      <div class="menuitem last">
        <a href="/support/">Support</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px" />
  <br style="height: 0px; clear: both" />
  </div><!-- /#headerbar -->

  <div id="content">

    <aside><div class="sidebar-warning" style="float: right;">
<h2>Date</h2>
May 5, 2017
<h2>Affected versions</h2>
<code>SimpleSAMLphp &lt;= 1.14.13</code>
<h2>Severity</h2>
Medium
<h2>References</h2>
CVE-2017-12869
</div></aside>

<h1 id="201704-02">201704-02</h1>

<p><strong>Authentication context bypass in the <em>multiauth</em> module</strong></p>

<h3 id="background">Background</h3>

<p>The <em>multiauth</em> module allows an Identity Provider to let the user choose which authentication mechanism he or she wants
to use. The authentication mechanisms are defined in the <code class="language-plaintext highlighter-rouge">config/authsources.php</code> configuration file, and a list of
valid sources for <em>multiauth</em> is defined in the configuration of the <em>multiauth</em> source itself.</p>

<h3 id="description">Description</h3>

<p>There is an issue in the <em>multiauth</em> module allowing an attacker to use any authentication source defined in the
configuration but not explicitly allowed in the configuration of the <em>multiauth</em> module. This issue was due to the lack
of proper validation of user’s input, resulting in the execution of arbitrary authentication sources even if they are
not configured by a system administrator to be used in this context.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>All <strong>SimpleSAMLphp</strong> versions before and including <strong>1.14.13</strong>.</p>

<h3 id="impact">Impact</h3>

<p>The fact that the <em>multiauth</em> module explicitly requires to configure a list of allowed authentication sources, makes
the system administrator of an Identity Provider assume only those authentication sources defined in that list will
be possibly used by end users when authenticating to services. However, the issue discussed here allows to authenticate
with other authentication sources, making it possible to bypass authentication or even impersonate other users depending
on the configuration of the IdP, provided that other authentication sources are defined that an attacker can use for
profit, even if they were not intended to be used by <em>multiauth</em>.</p>

<p>Even though the consequences can potentially be serious (an attacker authenticating to a service he or she doesn’t have
access to, or even impersonating other users or bypassing authentication completely), the ability to exploit this issue
depends on an improper configuration of the IdP, leaving authentication sources available that can be used by a
malicious user.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade to the <a href="/download">latest version</a>.</p>

<h3 id="credit">Credit</h3>

<p>This security issue was discovered and reported on April 28, 2017 by Michel Minsoul.</p>

    </div>    <!-- /#content -->

<div id="footer">
    <a href="https://www.uninett.no"><img id="ulogo" alt="notes" src="/res/uninettlogo.png" /></a>
</div><!-- /#footer -->


<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-431110-21");
        pageTracker._trackPageview();
    } catch (err) {
    }
</script>
  </body>
</html>
