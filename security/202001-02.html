<aside><div class="sidebar-warning" style="float: right;">
<h2>Date</h2>
January 24, 2020
<h2>Affected versions</h2>
<code>SimpleSAMLphp &lt;= 1.18.3</code><br />
<h2>Severity</h2>
Low
</div></aside>

<h1 id="202001-02">202001-02</h1>

<p><strong>Log injection</strong></p>

<h3 id="background">Background</h3>

<p>SimpleSAMLphp has a logging functionality that allows system administrators to keep track of the activity, errors, and
statistics. Additionally, it allows users to report errors, shall they happen. An error report contains a report
identifier, which is logged once submitted.</p>

<h3 id="description">Description</h3>

<p>The <code class="language-plaintext highlighter-rouge">www/errorreport.php</code> script, which receives error reports and sends them via email to the system administrator,
didnâ€™t properly sanitize the report identifier obtained from the request. This allows an attacker, under specific
circumstances, to inject new log lines by manually crafting this report ID.</p>

<p>When configured to use the <code class="language-plaintext highlighter-rouge">file</code> logging handler, SimpleSAMLphp will output all its logs by appending each log line to
a given file. Since the <code class="language-plaintext highlighter-rouge">reportID</code> parameter received in a request sent to <code class="language-plaintext highlighter-rouge">www/errorreport.php</code> was not properly
sanitized, it was possible to inject newline characters into it, effectively allowing a malicious user to inject new
log lines with arbitrary content.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>SimpleSAMLphp versions up to <strong>1.18.3</strong>.</p>

<h3 id="impact">Impact</h3>

<p>An attacker may use this issue to inject logs messages into a SimpleSAMLphp log file, trying to trick or confuse system
administrators. However, the attack surface is considered small, as the attack will only work with the <code class="language-plaintext highlighter-rouge">file</code> logging
handler, which opens the log file in <em>append-only</em> mode. This means an attacker cannot edit or remove existing log
messages, and even if non-ascii characters are written to the log, the file will always be readable with a simple text
editor.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade the SimpleSAMLphp installation to version <strong>1.18.4</strong>.</p>

<h3 id="credit">Credit</h3>

<p>This vulnerability was discovered and reported by Frederic Vleminckx on January 23, 2020.</p>
