<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SSPSA 202001-02: Log injection - SimpleSAMLphp</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.org/security/202001-02.html">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.org/feed.xml">
</head>

  <body>
      <!-- Red logo header -->
  <header>
  <div id="header">
    <div class="right">
      <form class="searchbox" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq">
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq">
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4">
        <input type="search" name="q" placeholder="Search" value="">
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.org">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <nav>
  <div id="headerbar">
  <p id="breadcrumb"><a href="https://simplesamlphp.org">Home</a> » SSPSA 202001-02: Log injection</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/support/">Support</a>
      </div>
      <div class="menuitem last">
        <a href="/contrib/">Contribute</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px">
    <br style="height: 0px; clear: both">
  </div><!-- /#headerbar -->
  </nav>
  </header>

  <main>

    <aside><div class="sidebar-warning right">
<h2>Date</h2>
January 24, 2020
<h2>Affected versions</h2>
<code>SimpleSAMLphp &lt;= 1.18.3</code><br />
<h2>Severity</h2>
Low
</div></aside>

<h1 id="202001-02">202001-02</h1>

<p><strong>Log injection</strong></p>

<h3 id="background">Background</h3>

<p>SimpleSAMLphp has a logging functionality that allows system administrators to keep track of the activity, errors, and
statistics. Additionally, it allows users to report errors, shall they happen. An error report contains a report
identifier, which is logged once submitted.</p>

<h3 id="description">Description</h3>

<p>The <code class="language-plaintext highlighter-rouge">www/errorreport.php</code> script, which receives error reports and sends them via email to the system administrator,
didn’t properly sanitize the report identifier obtained from the request. This allows an attacker, under specific
circumstances, to inject new log lines by manually crafting this report ID.</p>

<p>When configured to use the <code class="language-plaintext highlighter-rouge">file</code> logging handler, SimpleSAMLphp will output all its logs by appending each log line to
a given file. Since the <code class="language-plaintext highlighter-rouge">reportID</code> parameter received in a request sent to <code class="language-plaintext highlighter-rouge">www/errorreport.php</code> was not properly
sanitized, it was possible to inject newline characters into it, effectively allowing a malicious user to inject new
log lines with arbitrary content.</p>

<h3 id="affected-versions">Affected versions</h3>

<p>SimpleSAMLphp versions up to <strong>1.18.3</strong>.</p>

<h3 id="impact">Impact</h3>

<p>An attacker may use this issue to inject logs messages into a SimpleSAMLphp log file, trying to trick or confuse system
administrators. However, the attack surface is considered small, as the attack will only work with the <code class="language-plaintext highlighter-rouge">file</code> logging
handler, which opens the log file in <em>append-only</em> mode. This means an attacker cannot edit or remove existing log
messages, and even if non-ascii characters are written to the log, the file will always be readable with a simple text
editor.</p>

<h3 id="resolution">Resolution</h3>

<p>Upgrade the SimpleSAMLphp installation to version <strong>1.18.4</strong>.</p>

<h3 id="credit">Credit</h3>

<p>This vulnerability was discovered and reported by Frederic Vleminckx on January 23, 2020.</p>

    </main>

<footer>
    <img class="logo" src="/res/ssplogo-fish-2.svg" alt="">
</footer>

  </body>
</html>
