<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Language" content="en" />
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss" />

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Metadata processing performance</title>
  <meta name="description" content="SimpleSAMLphp** is an award-winning application written in native PHP that deals with authentication. It implements support for multiple protocols, most notably SAML, OpenID or OAuth.">

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
  <link rel="canonical" href="https://simplesamlphp.github.io/metaprocessing/">
  <link rel="alternate" type="application/rss+xml" title="SimpleSAMLphp" href="https://simplesamlphp.github.io/feed.xml" />
</head>

  <body>
      <!-- Red logo header -->
  <div id="header">
    <div class="right">
      <form style="margin-top: 2.5rem; margin-right: 2rem" method="get" action="https://www.google.com/cse">
        <input type="hidden" name="cx" value="004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="siteurl" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq" />
        <input type="hidden" name="adkw" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4" />
        <input type="search" name="q" placeholder="Search" value="" />
      </form>
    </div>
    <div class="v-center logo-header">
      <div id="logo">
        <a href="https://simplesamlphp.github.io" style="color: #fff; text-decoration: none">
          <span class="simple">Simple</span>
          <span class="saml">SAML</span>
          <span class="simple">php</span>
        </a>
      </div>
    </div>
    
  </div>

  <!-- Grey header bar below -->
  <div id="headerbar" style="clear: both">
  <p id="breadcrumb"><a href="https://simplesamlphp.github.io">Home</a> » Metadata processing performance</p>
    <div class="mtoolbar">
      <div class="menuitem first">
        <a href="/download">Download</a>
      </div>
      <div class="menuitem">
        <a href="/docs">Documentation</a>
      </div>
      <div class="menuitem">
        <a href="/security">Security</a>
      </div>
      <div class="menuitem">
        <a href="/modules/">Modules</a>
      </div>
      <div class="menuitem">
        <a href="/translation/">Translation</a>
      </div>
      <div class="menuitem">
        <a href="/developers/">Developers</a>
      </div>
      <div class="menuitem">
        <a href="https://github.com/simplesamlphp/simplesamlphp/projects">Roadmap</a>
      </div>
      <div class="menuitem">
        <a href="/awards">Awards</a>
      </div>
      <div class="menuitem">
        <a href="/users/">Users</a>
      </div>
      <div class="menuitem">
        <a href="/lists/">Mailing lists</a>
      </div>
      <div class="menuitem last">
        <a href="/support/">Support</a>
      </div>
    </div>
    <br style="clear: both; height: 0px; width: 0px" />
  <br style="height: 0px; clear: both" />
  </div><!-- /#headerbar -->

  <div id="content">

    <h1 id="metadata-processing-performance">Metadata processing performance</h1>

<p>Due to a <a href="https://bugs.php.net/bug.php?id=53655">known issue in XML canonicalization</a> in PHP, processing large metadata
files in SimpleSAMLphp takes a big amount of resources, with that amount growing approximately by the square of the
number of entities in the metadata set. In the context of this issue, <em>processing</em> means both verifying a signature of
metadata and also signing a new metadata document. This includes the initial parsing of a SAML metadata document, since
SimpleSAMLphp verifies the signature at the same time it parses the document.</p>

<p>As previously said, this is an issue specially for those people consuming or signing large metadata sets, as for
example the <a href="http://www.ukfederation.org.uk/"><em>UK Federation</em></a> or
<a href="http://www.geant.net/service/edugain/pages/home.aspx"><em>eduGAIN</em></a> metadata feeds.</p>

<p>Given the lack of response from the PHP team to solve this issue, we have applied <a href="https://github.com/simplesamlphp/xmlseclibs/commit/b51cc66d576608282272892278a5fc234d21ba34">a workaround for the problem</a> inside the
<a href="https://code.google.com/p/xmlseclibs/"><strong>xmlseclibs</strong></a> library, which has been included in <strong>SimpleSAMLphp version
1.13.2</strong>. This workaround is <strong>experimental</strong> and could lead to unexpected issues. We have tested it without issues for
a long time, both for verifying and creating signatures, but we can’t guarantee yet that it is completely free of side
effects. We are currently testing it more thoroughly (special thanks to the people at GÉANT Association) and we will
hopefully be able to discard any interoperability issues in a short time.</p>

<p>Meanwhile, all the users of SimpleSAMLphp that are members of the <em>UK Federation</em> or <em>eduGAIN</em> are encouraged to update
their installations to the new version 1.13.2. Since we cannot guarantee the absence of side effects, we recommend
installing a new, separate instance of SimpleSAMLphp to handle metadata processing, preferably in a different, dedicated
machine. Please note that starting <strong>November 17 of 2014</strong>, the <em>UK Federation</em> will dump most of its entities to the
<em>eduGAIN</em> metadata feed, making it impossible for SimpleSAMLphp to consume this feed.</p>

<p>For those using older versions of SimpleSAMLphp or having difficulties to update to the latest version, the workaround
can be applied by replacing the <strong>xmlseclibs</strong> library with <a href="https://github.com/simplesamlphp/xmlseclibs/blob/b51cc66d576608282272892278a5fc234d21ba34/xmlseclibs.php">this one</a>. Those who
are using <a href="https://getcomposer.org/">composer</a> can edit their <code class="highlighter-rouge">composer.json</code> file to change the version of
<strong>xmlseclibs</strong> they are running:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"simplesamlphp/xmlseclibs": "~1.3.2",
</code></pre></div></div>

<p>and then update it normally:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer.phar update
</code></pre></div></div>

<p>If you are running the updated library and experience unexpected behaviour, please do not hesitate to <a href="https://groups.google.com/forum/#!forum/simplesamlphp">contact
us</a> or <a href="https://github.com/simplesamlphp/simplesamlphp/issues">open an issue in the issue
tracker</a>.</p>

    </div>    <!-- /#content -->

<div id="footer">
    <a href="https://www.uninett.no"><img id="ulogo" alt="notes" src="/res/uninettlogo.png" /></a>
</div><!-- /#footer -->


<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-431110-21");
        pageTracker._trackPageview();
    } catch (err) {
    }
</script>
  </body>
</html>
